<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <title>מנהל דוחות כללי</title>
    <link href="../css/manual.css" rel="stylesheet" type="text/css">
    <script src="../js/toc.js"></script>
    <script src='http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js'></script>
    <script src="../js/back_to_top.js"></script>
</head>
<body onload="generateTOC(document.getElementById('toc'));" dir="rtl">
    <header>
        <nav><small><a id="go_home" href="../index.html?lang=he">מעבר לדף העזרה הראשי</a></small></nav>

        <a href="#" id="back-to-top"><img src="../img/backtotop.png" alt="חזרה לראש העמוד" /></a>
        <!--Smooth Back to Top Button End-->

        <h1>מנהל דוחות כללי</h1>
    </header>

    <!-- ToC generated by Javascript -->
    <nav id="toc"></nav>

    <h2>פתיחת מנהל הדוחות הכללי</h2>
    <p>
        הפעלת כלי מנהל הדוחות הכללי (<abbr>GRM</abbr>) או מהתפריט הראשי
        <kbd><samp>כלים</samp> &larr; <samp>מנהל דוחות כללי&hellip;</samp>
        </kbd>.
    </p>
    <img class="shadow" alt="סרגל הכלים GRM" src="../en_GB/grm_toolbar.png">

    <h2>הוספת דוח חדש</h2>
    <p>זמינות שתי אפשרויות להוספת דוחות חדשים.</p>

    <h3>יצירת הדוח מאפס</h3>
    <ol>
        <li>בעץ הניווט,  קליק ימני בעכבר
            על תוויות <kbd><samp>דוחות</samp></kbd>.</li>
        <li>בחירת <kbd><samp>דוח ריק חדש</samp></kbd> התפריט.</li>
        <li>הזנת שם קבוצת הדוח (קבוצה קיימת או קבוצה חדשה) ושם הדוח החדש.</li>
        <li>שינוי שם של דוח, אם נדרש, נעשה על ידי לחיצה ימנית על פריט התפריט:
            <kbd><samp>שינוי שם דוח</samp></kbd>.</li>
        <li>יוצגו ארבע לשוניות: פלט, SQL, Lua, תבנית ותיאור.</li>
        <li>
            בלשונית: SQL, מזינים את תסריט SQL לתוך חלון העורך,
            יש לוודא שהתסריט מסתיים בנקודה-פסיק (;) ולאחר מכן יש להקיש
            על לחצן <kbd><samp>שמירה</samp></kbd>.
        </li>
        <li>הקשה על לחצן <kbd><samp>בדיקה</samp></kbd> להרצת תסריט
       ה- SQL.</li>
        <li>אם הבדיקה עברה בהצלחה לחצן
            <kbd><samp>יצירת תבנית</samp></kbd> יהפוך לזמין. יש ללחץ על הלחצן כדי ליצור תבנית
            HTML עבור הדוח.</li>
        <li>הקשה על לחצן <kbd><samp>הרצה</samp></kbd> כדי להציג את דוח
        במבנה HTML בחלון הפלט.</li>
    </ol>
    <img class="shadow" alt="אנימציה ליצירת דוח חדש מאפס"
    src="../en_GB/grm.gif">

    <h4>משתני דוח</h4>
    <p>
        בגירסה 1.4.0 של MMEX קיימת אפשרות להעברת תאריכים לתסריט SQL של דוח.
        קיימות ארבע אפשרויות לבצע זאת:   <var>&single_date</var>,
        <var>&begin_date</var>, <var>&end_date</var>, <var>&budget_years</var>.
        ככל שתסריט ה SQL יכלול את אחד המשתנים שלעיל הוא
        יוחלף בתאריך מוִידְגֶ'ט לוח השנה.
        לדוגמה, הרצת תסריט SQL זה יחזיר את כל יתרות החשבונות
        לתאריך שהוגדר:
    </p>
<pre><code class="language-sql">with b as  (
    select ACCOUNTID, STATUS
        , (case when TRANSCODE = 'Deposit' then TRANSAMOUNT else -TRANSAMOUNT end) as TRANSAMOUNT
        , TRANSDATE
    from CHECKINGACCOUNT
    union all
    select TOACCOUNTID, STATUS, TOTRANSAMOUNT ,TRANSDATE
    from CHECKINGACCOUNT
    where TRANSCODE = 'Transfer'
    )
select a.ACCOUNTNAME,
total(TRANSAMOUNT) + a.INITIALBAL as Balance
from ACCOUNTLIST as a, b
where a.STATUS = 'Open'
    and b.ACCOUNTID = a.ACCOUNTID
    and b.STATUS &lt;&gt; 'V'
    and b.TRANSDATE &lt;= '<var>&single_date</var>'
group by a.ACCOUNTNAME order by a.ACCOUNTNAME asc;
 
Text
XPath: /html/body/pre/code
</code></pre>
    <img class="shadow" alt="דוגמאת פלט דוח GRM תוך שימוש 
במשתנה תאריך יחיד" src="../en_GB/grm_custom_date.png">

    <h3>ייבוא דוח מוכן</h3>
    <p>
        ישנם ב- <a href="https://github.com/moneymanagerex/general-reports/releases">GitHub</a> הרבה דוחות שסופקו על-ידי משתמשים או מפתחים
    </p>

    <h2>הגדרות ייצוא דוח</h2>
    <p>
        אם יצרתם דוחות שימושיים ניתן ליצאם לקובץ ZIP.
    </p>

    <footer><p><small>
        זכויות יוצרים &copy; 2005-2009 מדחן קאנאגבל<br>
זכויות יוצרים &copy; 2013-2019 קהילת תומכי MMEX<br>
<span id="translator"> מתרגמים:  קהילת תומכי MMEX</span>
    </small></p></footer>
    <script>
        var LANG = document.getElementsByTagName('html')[0].getAttribute('lang');
        var tr = document.getElementById("translator");
        if (LANG == 'en')
            tr.parentNode.removeChild(tr);
    </script>

</body>
</html>
