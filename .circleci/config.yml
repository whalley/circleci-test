version: 2.1
jobs:
  build:
    machine: true
    steps: 
      - checkout
 #     - run: 
 #         name: Build wxWidgets
 #         command: wget https://github.com/wxWidgets/wxWidgets/releases/download/v3.1.7/wxWidgets-3.1.7.zip && unzip -d wxWidgets wxWidgets-3.1.7.zip && cd wxWidgets && mkdir build-linux && cd build-linux && ../configure --disable-shared --enable-cxx11 --with-cxx=11 --enable-webview --with-gtk=3 --enable-unicode --enable-intl && make
      - run: 
          name: Build MoneyManagerEx
          command: docker run -it --rm -w /moneymanagerex/build -v $HOME/.ccache:/root/.ccache -v $CIRCLE_WORKING_DIRECTORY:/moneymanagerex whall3y/mmex:ubuntu-bionic bash -c "ls -l /wxWidgets/build-linux/wx-config &&cmake .. && cmake -DCMAKE_BUILD_TYPE=Release -DwxWidgets_CONFIG_EXECUTABLE=/wxWidgets/build-linux/wx-config --build . --target package && eval \$MMEX_INST_CMD"
